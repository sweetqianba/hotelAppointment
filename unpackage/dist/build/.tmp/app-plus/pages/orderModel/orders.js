(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/orderModel/orders"],{"2ae7":function(t,a,e){"use strict";var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("view",{staticClass:"content",attrs:{eventid:"5c88a5fd-16"},on:{touchstart:t.TouchStart,touchmove:t.ListTouchMove,touchend:t.ListTouchEnd}},[e("view",{staticClass:"cu-card case bg-white",staticStyle:{position:"fixed",top:"0","z-index":"9999",width:"750rpx"}},[e("scroll-view",{staticClass:"bg-white nav",attrs:{"scroll-x":""}},[e("view",{staticClass:"flex text-center"},t._l(t.tabBar,function(a,i){return e("view",{key:i,staticClass:"cu-item flex-sub",class:i===t.tabCur?"text-blue cur":"",attrs:{"data-id":i,eventid:"5c88a5fd-0-"+i},on:{tap:t.tabSelect}},[t._v(t._s(a.name))])}))])],1),e("view",{}),0!==t.data.length?e("view",{staticClass:"cu-card case",staticStyle:{"margin-top":"40px"}},[t._l(t.data,function(a,i){return e("view",{key:i,staticClass:"cu-item shadow",attrs:{eventid:"5c88a5fd-9-"+i},on:{tap:function(e){t.toDetails(a)}}},[e("view",{staticClass:"solid-bottom flex justify-between",staticStyle:{padding:"10rpx 30rpx"}},[e("view",{staticClass:"text-lg"},[e("text",[t._v(t._s(a.hotelname))])]),e("view",[e("text",[t._v(t._s(a.status))])])]),e("view",{staticClass:"flex justify-start",staticStyle:{padding:"10rpx 30rpx"}},[e("view",{staticClass:"image",staticStyle:{width:"120rpx",overflow:"hidden",position:"relative"}},[e("image",{staticClass:"radius",staticStyle:{height:"120rpx"},attrs:{src:a.images,mode:"aspectFill"}})]),e("view",{staticClass:"margin-left"},[e("view",[e("text",[t._v("数量："+t._s(a.housenum))])]),e("view",[e("text",[t._v("支付金额：￥"+t._s(a.price))])])])]),"待付款"==a.status?e("view",{staticClass:"flex justify-end"},[e("view",{staticClass:"margin-xs radius"},[e("button",{staticClass:"cu-btn round",attrs:{eventid:"5c88a5fd-1-"+i},on:{tap:function(e){e.stopPropagation(),t.goPay(a)}}},[t._v("去支付")])],1),e("view",{staticClass:"margin-xs radius"},[e("button",{staticClass:"cu-btn round",attrs:{eventid:"5c88a5fd-2-"+i},on:{tap:function(e){e.stopPropagation(),t.goCancel(a)}}},[t._v("取消预订")])],1)]):t._e(),"待使用"==a.status?e("view",{staticClass:"flex justify-end"},[e("view",{staticClass:"margin-xs radius"},[e("button",{staticClass:"cu-btn round",attrs:{eventid:"5c88a5fd-3-"+i},on:{tap:function(e){e.stopPropagation(),t.goFinish(a)}}},[t._v("使用完成")])],1),e("view",{staticClass:"margin-xs radius"},[e("button",{staticClass:"cu-btn round",attrs:{eventid:"5c88a5fd-4-"+i},on:{tap:function(e){e.stopPropagation(),t.goPayAgain(a)}}},[t._v("再次预订")])],1),e("view",{staticClass:"margin-xs radius"},[e("button",{staticClass:"cu-btn round",attrs:{eventid:"5c88a5fd-5-"+i},on:{tap:function(e){e.stopPropagation(),t.goRefund(a)}}},[t._v("退款")])],1)]):t._e(),"待评价"==a.status?e("view",{staticClass:"flex justify-end"},[e("view",{staticClass:"margin-xs radius"},[e("button",{staticClass:"cu-btn round",attrs:{eventid:"5c88a5fd-6-"+i},on:{tap:function(e){e.stopPropagation(),t.goEvaluate(a)}}},[t._v("去评价")])],1),e("view",{staticClass:"margin-xs radius"},[e("button",{staticClass:"cu-btn round",attrs:{eventid:"5c88a5fd-7-"+i},on:{tap:function(e){e.stopPropagation(),t.goPayAgain(a)}}},[t._v("再次预订")])],1)]):t._e(),"退款/售后"==a.status?e("view",{staticClass:"flex justify-end"},[e("view",{staticClass:"margin-xs radius"},[e("button",{staticClass:"cu-btn round",attrs:{eventid:"5c88a5fd-8-"+i},on:{tap:function(e){e.stopPropagation(),t.goPayAgain(a)}}},[t._v("再次预订")])],1)]):t._e()])}),e("view",{staticClass:"cu-modal bottom-modal",class:t.evaluateStatus?"show":""},[e("view",{staticClass:"cu-dialog"},[e("view",{staticClass:"cu-bar bg-white"},[e("view",{staticClass:"action text-green",attrs:{eventid:"5c88a5fd-10"},on:{tap:t.submitEvaluate}},[t._v("确定")]),e("view",{staticClass:"action text-blue",attrs:{eventid:"5c88a5fd-11"},on:{tap:function(a){t.evaluateStatus=!1}}},[t._v("取消")])]),e("view",{staticClass:"padding-xl"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.evaluate.type,expression:"evaluate.type"}],attrs:{type:"text",placeholder:"请填写评价的类型",eventid:"5c88a5fd-12"},domProps:{value:t.evaluate.type},on:{input:function(a){a.target.composing||(t.evaluate.type=a.target.value)}}}),e("input",{directives:[{name:"model",rawName:"v-model",value:t.evaluate.info,expression:"evaluate.info"}],attrs:{type:"text",placeholder:"请填写评价的信息",eventid:"5c88a5fd-13"},domProps:{value:t.evaluate.info},on:{input:function(a){a.target.composing||(t.evaluate.info=a.target.value)}}}),e("view",{staticClass:"cu-form-group"},[e("view",{staticClass:"grid col-3 grid-square flex-sub"},[t._l(t.files,function(a,i){return e("view",{key:i,staticClass:"padding-xs bg-img",style:"background-image:url("+a+");"},[e("view",{staticClass:"cu-tag bg-red",attrs:{eventid:"5c88a5fd-14-"+i},on:{click:function(a){t.removeImg(i)}}},[e("text",{staticClass:"icon-close"})])])}),t.files.length?t._e():e("view",{staticClass:"padding-xs solids",attrs:{eventid:"5c88a5fd-15"},on:{click:function(a){t.chooseImage()}}},[e("text",{staticClass:"icon-cameraadd"})])],2)])])])])],2):e("view",{staticStyle:{"margin-top":"500rpx","text-align":"center"}},[t._v("暂无订单")])])},s=[];e.d(a,"a",function(){return i}),e.d(a,"b",function(){return s})},"3c35":function(t,a,e){"use strict";e.r(a);var i=e("8eba"),s=e.n(i);for(var n in i)"default"!==n&&function(t){e.d(a,t,function(){return i[t]})}(n);a["default"]=s.a},"7c7b":function(t,a,e){"use strict";e.r(a);var i=e("2ae7"),s=e("3c35");for(var n in s)"default"!==n&&function(t){e.d(a,t,function(){return s[t]})}(n);var o=e("2877"),c=Object(o["a"])(s["default"],i["a"],i["b"],!1,null,null,null);a["default"]=c.exports},"8eba":function(t,a,e){"use strict";(function(t){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i=e("6b33"),s=e("86a5"),n=e("0a20"),o=e("51bd"),c=e("954b"),u="http://p0.meituan.net/tdchotel/1938994348a6ade29a5c6bf2fdf02ae15542536.jpg@220w_125h_1e_1c",r={data:function(){return{tabBar:i.orders.tabBar,tabCur:0,img:u,data:[],evaluateStatus:!1,evaluate:{},files:[]}},onShow:function(){this.getOrderInfoByStatus()},methods:{tabSelect:function(t){this.tabCur=t.currentTarget.dataset.id},TouchStart:function(t){this.ListTouchStart=t.touches[0].pageX,this.ListTouchStartY=t.touches[0].pageY},ListTouchMove:function(t){this.touchDirection=null,Math.abs(t.touches[0].pageY-this.ListTouchStartY)<20&&Math.abs(t.touches[0].pageX-this.ListTouchStart)>50&&(this.touchDirection=t.touches[0].pageX-this.ListTouchStart>0?"right":"left")},ListTouchEnd:function(t){"left"==this.touchDirection?this.turnRight():"right"==this.touchDirection&&this.turnLeft()},turnRight:function(){5===this.tabCur?t.showToast({icon:"none",title:"没有啦，请向左滑"}):this.tabCur++},turnLeft:function(){0===this.tabCur?t.showToast({icon:"none",title:"没有啦，请向右滑"}):this.tabCur--},toDetails:function(a){t.navigateTo({url:"orderDetails/orderDetails?id="+a.id})},getOrderInfoByStatus:function(){var t=this,a={status:this.tabBar[this.tabCur].name};"全部"==this.tabBar[this.tabCur].name&&delete a.status,(0,s.getOrderInfoByStatus)(a).then(function(a){200==a.errno?t.data=a.data:t.data=[]}).catch(function(t){})},goPay:function(a){t.navigateTo({url:"../homeModel/homePay/homePay?price="+a.price+"&id="+a.id})},goCancel:function(a){var e=this;t.showModal({title:"提示",content:"确定要取消订单吗？",success:function(i){if(!i.cancel){var n={orderId:a.id};(0,s.deleteOrder)(n).then(function(a){200==a.errno&&(e.getOrderInfoByStatus(),t.showToast({icon:"none",title:"取消订单成功"}))}).catch(function(t){})}}})},goPayAgain:function(a){t.navigateTo({url:"../homeModel/home?hotelId="+a.hotelId})},goEvaluate:function(t){this.evaluateStatus=!0,this.evaluate.orderId=t.id,this.evaluate.hotelId=t.hotelId},goRefund:function(a){var e=this;t.showModal({title:"确定要退款吗？",content:"退款之后，房费会自动返回到您的钱包里",cancelText:"取消",confirmText:"确定",success:function(i){if(!i.cancel){var n={id:a.id,status:"退款/售后"};(0,s.postOrder)(n).then(function(i){if(200==i.errno){e.getOrderInfoByStatus();var s=t.getStorageSync("userInfo").money,n={money:Number(s)+Number(a.price)};(0,o.appUpdInfo)(n).then(function(a){200==a.errno&&(0,c.putUserInfo)(a).then(function(a){t.showToast({title:"退款成功"})}).catch(function(t){})}).catch(function(t){})}}).catch(function(t){})}}})},removeImg:function(t){this.files.splice(t,1)},previewImage:function(a){t.previewImage({current:a.currentTarget.id,urls:this.files})},chooseImage:function(a){var e=this;t.chooseImage({count:1,sizeType:["compressed"],sourceType:["album","camera"],success:function(t){e.files=e.files.concat(t.tempFilePaths)}})},uploadImg:function(a){return new Promise(function(e,i){t.uploadFile({url:"https://www.sweetqianba.com/fastDfs/uploadFile",filePath:a,name:"file",success:function(t){e(t.data)},fail:function(t){i(t)}})})},submitEvaluate:function(){var a=this;this.uploadImg(this.files[0]).then(function(e){if(e=JSON.parse(e),"上传成功"===e.success){t.showToast({icon:"none",title:"上传成功"});var i={image:"https://"+e.URL,detail:a.evaluate.info,type:a.evaluate.type,hotelId:a.evaluate.hotelId},o={id:a.evaluate.orderId,status:"已完成"};(0,n.addEvaluate)(i).then(function(e){a.evaluateStatus=!1,(0,s.postOrder)(o).then(function(e){200==e.errno&&(a.getOrderInfoByStatus(),t.showToast({icon:"none",title:"评价成功"}))}).catch(function(t){})}).catch(function(t){})}}).catch(function(t){})},goFinish:function(a){var e=this,i={id:a.id,status:"待评价"};(0,s.postOrder)(i).then(function(a){200==a.errno&&(e.getOrderInfoByStatus(),t.showToast({icon:"none",title:"修改成功"}))}).catch(function(t){})}},watch:{tabCur:function(a,e){var i=this;this.data=[],t.showToast({icon:"loading",title:"客观，请稍等",mask:!0,duration:1e3,success:function(){i.getOrderInfoByStatus()}})}}};a.default=r}).call(this,e("6e42")["default"])},d349:function(t,a,e){"use strict";e("17f3");var i=n(e("b0ce")),s=n(e("7c7b"));function n(t){return t&&t.__esModule?t:{default:t}}Page((0,i.default)(s.default))}},[["d349","common/runtime","common/vendor"]]]);