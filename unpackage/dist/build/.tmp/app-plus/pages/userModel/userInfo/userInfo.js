(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/userModel/userInfo/userInfo"],{"076b":function(t,e,s){"use strict";s("17f3");var a=i(s("b0ce")),c=i(s("8cce"));function i(t){return t&&t.__esModule?t:{default:t}}Page((0,a.default)(c.default))},"2eb7":function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("view",[s("view",{staticClass:"cu-list menu margin-top"},[s("view",{staticClass:"cu-item arrow",attrs:{eventid:"fa5864bc-0"},on:{tap:t.showPicModal}},[s("view",{staticClass:"content flex justify-between",staticStyle:{margin:"10rpx 0"}},[s("text",{staticClass:"text-black",staticStyle:{"line-height":"48px"}},[t._v("头像")]),s("view",{staticClass:"cu-avatar lg round",style:{backgroundImage:"url("+(t.userInfo.pic||"")+")"}})])]),s("view",{staticClass:"cu-item arrow",attrs:{eventid:"fa5864bc-1"},on:{tap:t.showAccountModal}},[s("view",{staticClass:"content flex justify-between"},[s("text",{staticClass:"text-black"},[t._v("昵称")]),s("text",{staticClass:"text-black"},[t._v(t._s(t.userInfo.account||"暂无"))])])]),t._m(0)]),s("view",{staticClass:"cu-modal bottom-modal",class:t.accountStatus?"show":""},[s("view",{staticClass:"cu-dialog"},[s("view",{staticClass:"cu-bar bg-white"},[s("view",{staticClass:"action text-green",attrs:{eventid:"fa5864bc-2"},on:{tap:t.submitAccount}},[t._v("确定")]),s("view",{staticClass:"action text-blue",attrs:{eventid:"fa5864bc-3"},on:{tap:t.hideAccountModal}},[t._v("取消")])]),s("view",{staticClass:"padding-xl"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.userInfo.account,expression:"userInfo.account"}],attrs:{type:"text",eventid:"fa5864bc-4"},domProps:{value:t.userInfo.account},on:{input:function(e){e.target.composing||(t.userInfo.account=e.target.value)}}})])])]),s("view",{staticClass:"cu-modal bottom-modal",class:t.picStatus?"show":""},[s("view",{staticClass:"cu-dialog"},[s("view",{staticClass:"cu-bar bg-white"},[s("view",{staticClass:"action text-green",attrs:{eventid:"fa5864bc-5"},on:{tap:t.submitPic}},[t._v("确定")]),s("view",{staticClass:"action text-blue",attrs:{eventid:"fa5864bc-6"},on:{tap:t.hidePicModal}},[t._v("取消")])]),s("view",{staticClass:"padding-xl"},[s("view",{staticClass:"cu-form-group"},[s("view",{staticClass:"grid col-3 grid-square flex-sub"},[t._l(t.files,function(e,a){return s("view",{key:a,staticClass:"padding-xs bg-img",style:"background-image:url("+e+");"},[s("view",{staticClass:"cu-tag bg-red",attrs:{eventid:"fa5864bc-7-"+a},on:{click:function(e){t.removeImg(a)}}},[s("text",{staticClass:"icon-close"})])])}),t.files.length?t._e():s("view",{staticClass:"padding-xs solids",attrs:{eventid:"fa5864bc-8"},on:{click:function(e){t.chooseImage()}}},[s("text",{staticClass:"icon-cameraadd"})])],2)])])])])])},c=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("view",{staticClass:"cu-item arrow"},[s("view",{staticClass:"content flex justify-between"},[s("text",{staticClass:"text-black"},[t._v("生日")]),s("text",{staticClass:"text-black"},[t._v("未设置")])])])}];s.d(e,"a",function(){return a}),s.d(e,"b",function(){return c})},"8cce":function(t,e,s){"use strict";s.r(e);var a=s("2eb7"),c=s("a3b3");for(var i in c)"default"!==i&&function(t){s.d(e,t,function(){return c[t]})}(i);var n=s("2877"),o=Object(n["a"])(c["default"],a["a"],a["b"],!1,null,null,null);e["default"]=o.exports},a3b3:function(t,e,s){"use strict";s.r(e);var a=s("f7bc"),c=s.n(a);for(var i in a)"default"!==i&&function(t){s.d(e,t,function(){return a[t]})}(i);e["default"]=c.a},f7bc:function(t,e,s){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=s("51bd"),c=s("954b"),i={data:function(){return{userInfo:{pic:null},accountStatus:!1,picStatus:!1,files:[]}},onShow:function(){var e=t.getStorageSync("userInfo");this.userInfo=e,console.log(JSON.stringify(this.userInfo))},methods:{hideAccountModal:function(){this.accountStatus=!1},showAccountModal:function(){this.accountStatus=!0},submitAccount:function(){if(this.userInfo.account){var e={account:this.userInfo.account};(0,a.appUpdInfo)(e).then(function(e){(0,c.putUserInfo)(e).then(function(e){t.showToast({icon:"none",title:"修改成功"})}).catch(function(t){})}).catch(function(t){})}else t.showToast({icon:"none",title:"请先输入昵称"})},hidePicModal:function(){this.picStatus=!1},showPicModal:function(){this.picStatus=!0},uploadImg:function(e){return new Promise(function(s,a){t.uploadFile({url:"https://www.sweetqianba.com/fastDfs/uploadFile",filePath:e,name:"file",success:function(e){this.userInfo=t.getStorageSync("userInfo"),this.userInfo.pic="https://"+JSON.parse(e.data).URL,console.log(JSON.parse(e.data).URL),s(e.data)},fail:function(t){a(t)}})})},submitPic:function(){var e=this;this.uploadImg(this.files[0]).then(function(s){if(s=JSON.parse(s),"上传成功"===s.success){t.showToast({icon:"none",title:"上传成功"});var i={pic:"https://"+s.URL};(0,a.appUpdInfo)(i).then(function(t){(0,c.putUserInfo)(t).then(function(t){e.accountStatus=!1,e.picStatus=!1}).catch(function(t){})}).catch(function(t){})}}).catch(function(t){})},removeImg:function(t){this.files.splice(t,1)},previewImage:function(e){t.previewImage({current:e.currentTarget.id,urls:this.files})},chooseImage:function(e){var s=this;t.chooseImage({count:1,sizeType:["compressed"],sourceType:["album","camera"],success:function(t){s.files=s.files.concat(t.tempFilePaths)}})}}};e.default=i}).call(this,s("6e42")["default"])}},[["076b","common/runtime","common/vendor"]]]);